# Marigold -reality-

## Description

万寿菊，象征着万寿无疆，象征着自强不息，象征着与命运的抗争。

这场突如其来的车祸，让Alice永远失去了在最后一刻挺身而出保护自己的哥哥，也因此昏迷了好久，失去了大部分记忆。在昏迷的这段时间里，她做了如此美妙的一个梦，在梦里能听着Deemo弹起一首首熟悉的钢琴曲……

----------

这座城市共有$n$个部落，存在$m$条无向的道路，每条连接两个部落，并且**保证任意两个部落间均可以通过这些道路互相到达**。每条道路存在一个长度$w$。两个部落间最多只有一条**直连**的道路。

Alice开始在这座城市里寻找丢失的记忆。受哥哥的影响，她记得一些重要的部落对$(u_i,v_i)$，因为哥哥以前总是带她沿着最短路径在这些部落对中走动。为此，她决定**走一遍每对部落对之间的最短路径**。

但又因为昏迷的这段时间里，这$m$条无向路中**有一条路**被进行了改造，Alice听说这条路的长度**最多**减少了$L$。换句话说，如果这条路原长度为$w$，则现长度应为$\max(0,w-L)$。

Alice不知道具体是哪条路被改造了，但她想知道在最优情况下，她记忆中所有部落对之间**距离总和的最小值$\min\{\sum_{i=1}^k distance(u_i,v_i)\}$**是多少。

## Input

第一行包含四个整数$n,m,k,L$（$1\leq n\leq 800$，$n-1\leq m\leq min(800,\frac{n(n-1)}{2})$，$1\leq k\leq 2000$，$1\leq L\leq 1000$），分别代表部落的数量，道路的数量，Alice记忆中部落对的对数，以及改造的路最多减少的长度。

其后$m$行，每行$3$个整数$u,v,w$（$1\leq u,v\leq n$，$u\neq v$，$1\leq w\leq 1000$），代表$u$和$v$之间原先存在一条长度为$w$的道路。

其后$k$行，每行$2$个整数$u,v$（$1\leq u,v\leq n$，$u\neq v$），表示Alice记忆中的部落对。

## Output

输出仅一个整数，Alice所需要走的路长度总和的最小值，即$\min\{\sum_{i=1}^k distance(u_i,v_i)\}$。

## Sample Input

```
6 5 2 3
1 2 5
2 3 7
2 4 4
4 5 2
4 6 8
1 6
5 3


5 5 4 3
1 2 5
2 3 4
1 4 3
4 3 7
3 5 2
1 5
1 3
3 3
1 5
```

## Sample Output

```
24


22
```

## Hint

对于样例$1$：

首先，如果不考虑道路改造

那么$1$至$6$的最短路为$1-2-4-6$，长度为$5+4+8=17$；$5$至$3$的最短路为$5-4-2-3$，长度为$2+4+7=13$；总长度为$30$

考虑道路改造

- 如果改造的是$1-2$，原长度为$5$，改造后为$5-L=5-3=2$，原$1$至$6$的最短路长度将会减少$3$，故最终总长度为$27$
- 如果改造的是$2-3$，改造后长度为$7-3=4$，原$5$至$3$的最短路长度将会减少$3$，故最终总长度为$27$
- 如果改造的是$2-4$，改造后长度为$3-3=0$，原$1$至$6$及$5$至$3$的最短路长度都将会减少$3$，故最终总长度为$24$
- 如果改造的是$4-5$，改造后长度为$max(2-3,0)=0$，原$5$至$3$的最短路长度将会减少$2$，故最终总长度为$28$
- 如果改造的是$4-6$，改造后长度为$8-3=5$，原$1$至$6$的最短路长度将会减少$3$，故最终总长度为$27$

综上，如果改造的是$2-4$，则Alice走的道路总长度最短，为$24$。

## Source

Author StelaYuri From ACM Club

